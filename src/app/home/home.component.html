



<p-button [icon]="sidebarVisible? 'pi pi-filter-slash' :  'pi pi-filter'" class="sticky top-0 p-3 z-2" [rounded]="true" [text]="true" severity="primary " (click)="toggleSidebar()"></p-button>


<div class="row flex" >
  <div class="wrapper new" [class.sidebar-visible]="sidebarVisible" [@slideInOut]="sidebarState"  >
      <div class="sidebar">
              <div class="box">
              <form [formGroup]="formulario" (ngSubmit)="filtrarDashboard()">

                <div class="h-11rem">
                  <span class="text-x1 font-bold flex  ml-5 mt-3">Data&nbsp;&nbsp;
                    <i class="pi pi-info-circle" style="font-size: 1rem" style="color: #FFACA7"
                    pTooltip="O filtro de data será aplicado por um periodo de inicio e fim, e todos os graficos seram alterados para o filtro escolhido."
                    tooltipPosition="right"
                    ></i>
                  </span>
                  <div class="mt-5">

                    <div class="field flex justify-content-center">
                      <span class="p-float-label  p-input-icon-right">
                        <p-calendar
                          [iconDisplay]="'input'"
                          [showIcon]="true"
                          appendTo="body"
                          [autoZIndex]="true"

                          inputId="dataConsulta"
                          dateFormat="dd/mm/yy"
                          [showButtonBar]="true"
                          [style]="{'color':'#2070B4', 'width': '11vw'}"
                          formControlName="dataInicio"

                          >
                          <ng-template pTemplate="inputicon" let-clickCallBack="clickCallBack" class="p-input-icon-right">
                            <i class="pi pi-calendar azul" (click)="clickCallBack($event)"></i>
                          </ng-template>
                        </p-calendar>
                        <label for="dataConsulta" class="azul">De</label>
                      </span>

                    </div>
                    <div class="field flex justify-content-center">
                      <span class="p-float-label  p-input-icon-right">
                        <p-calendar
                          [iconDisplay]="'input'"
                          [showIcon]="true"
                          appendTo="body"
                          [autoZIndex]="true"
                          inputId="dataConsulta"
                          dateFormat="dd/mm/yy"
                          [showButtonBar]="true"
                          [style]="{'color':'#2070B4', 'width': '11vw'}"
                          formControlName="dataFim"

                          >
                          <ng-template pTemplate="inputicon" let-clickCallBack="clickCallBack" class="p-input-icon-right">
                            <i class="pi pi-calendar azul" (click)="clickCallBack($event)"></i>
                          </ng-template>
                        </p-calendar>
                        <label for="dataConsulta" class="azul">Até</label>
                      </span>

                    </div>
                  </div>
                </div>

                <p-divider></p-divider>

                <div class="h-7rem">
                  <span class="text-x1 font-bold flex  ml-5">Dentista&nbsp;&nbsp;
                    <i class="pi pi-info-circle" style="font-size: 1rem" style="color: #FFACA7"
                    pTooltip="O filtro de Dentista é acumulativo com os filtros de data e procedimentos."
                    tooltipPosition="right"
                    ></i>
                  </span>
                  <div class="field flex justify-content-center mt-5">
                    <span class="p-float-label p-input-icon-right">
                      <i class="pi pi-user"></i>
                      <p-dropdown [options]="data.dentistasList" formControlName="dentista" optionLabel="nome" inputId="float-label" [style]="{'color':'#2070B4', 'width': '11vw'}" ></p-dropdown>
                      <label for="float-label" class="azul">Escolha uma opção</label>
                    </span>
                  </div>
                </div>

                <p-divider></p-divider>

                <div class="h-7rem">
                  <span class="text-x1 font-bold flex  ml-5">Procedimentos&nbsp;&nbsp;
                    <i class="pi pi-info-circle" style="font-size: 1rem" style="color: #FFACA7"
                    pTooltip="O filtro de Procedimentos é acumulativo com os filtros de Data e Dentista."
                    tooltipPosition="right"
                    ></i>
                  </span>
                  <div class="field flex justify-content-center mt-5">
                    <span class="p-float-label p-input-icon-right">
                      <i class="pi pi-user"></i>
                      <p-dropdown [options]="data.procedimentos" formControlName="procedimento" optionLabel="tipo" inputId="float-label" [style]="{'color':'#2070B4', 'width': '11vw'}"></p-dropdown>
                      <label for="float-label" class="azul">Escolha uma opção</label>
                    </span>
                  </div>
                </div>

                <p-divider></p-divider>

                <div class="h-7rem">
                  <span class="text-x1 font-bold flex  ml-5">Especialidade&nbsp;&nbsp;
                    <i class="pi pi-info-circle" style="font-size: 1rem" style="color: #FFACA7"
                    pTooltip="O filtro de Especialidade é acumulativo somente com o filtro de Data."
                    tooltipPosition="right"
                    ></i>
                  </span>
                  <div class="field flex justify-content-center mt-5">
                    <span class="p-float-label p-input-icon-right">
                      <i class="pi pi-user"></i>
                      <p-dropdown [options]="data.especialidades" formControlName="especialidade" optionLabel="tipo" inputId="float-label" [style]="{'color':'#2070B4', 'width': '11vw'}"></p-dropdown>
                      <label for="float-label" class="azul">Escolha uma opção</label>
                    </span>
                  </div>
                </div>



                <div class="flex justify-content-center align-items-center h-6rem">
                  <button pButton label="Limpar" icon="pi pi-filter-slash" class="limpar"></button>
                  <button pButton type="submit" label="Filtrar"  icon="pi pi-filter"></button>
                </div>
              </form>
              </div>
      </div>
  </div>

  <div class="w-full ">
      <div class="flex justify-content-between  px-3">
          <div class="card flex" >
            <div class="col-6 py-4 " >
              <div class="row flex justify-content-start align-items-center ml-2">
                <span class="font-bold text-600 text-3x1 text-3xl " >{{this.data.qtdPacienteMes[0]}} novos</span>
              </div>
              <div class="row flex">
                <span class="text-lg text-600 font-medium ml-2 mr-3 ">Pacientes</span>
                <div class="flex align-items-center">
                    <span [class]="this.data.qtdPacienteMes[0] > this.data.qtdPacienteMes[1]? 'backGreen':'backRed'">
                     <i [class]="this.data.qtdPacienteMes[0] > this.data.qtdPacienteMes[1]?
                      'pi pi-arrow-up-right text-xs font-bold text-green-500' : 'pi pi-arrow-down-right text-xs font-bold text-red-400'"
                      ></i>
                   </span>
                   <span [class]="this.data.qtdPacienteMes[0] > this.data.qtdPacienteMes[1]?
                    'font-medium text-sm text-green-500 ml-1' : 'font-medium text-sm text-red-400 ml-1'"
                    >{{ calculaPorcentagem(this.data.qtdPacienteMes[0], this.data.qtdPacienteMes[1]) | percent: '1.1' }} </span>

                </div>
              </div>
            </div>
            <div class="col-6 flex justify-content-end align-items-center">
              <div class="absolute z-0 px-3">
                <i class="pi pi-user-plus text-8xl text-100"></i>
              </div>
              <div class="pt-2">
                <p-chart type="line"
                  height="80"
                  width="180"
                  [responsive]="true"
                  [data]="{
                    labels: [ '', '', '', '','',''],
                    datasets: [
                      {
                        fill: false,
                        data: [this.data.qtdPacienteMes[5],this.data.qtdPacienteMes[4], this.data.qtdPacienteMes[3], this.data.qtdPacienteMes[2], this.data.qtdPacienteMes[1], this.data.qtdPacienteMes[0] ],
                        borderColor: this.data.qtdMes[0] < this.data.qtdMes[1]? '#FF6259':'#4CD07D',
                        tension: 0.4
                      }
                    ],
                  }"
                  [options]="{
                    maintainAspectRatio: false,
                    aspectRatio: 2,
                    name: false,
                    plugins: {
                      legend: {
                        display: false
                      }
                    },
                    scales: {
                        x: {
                          display: false,
                          ticks: {
                              color: 'transparent',
                            },
                            grid: {
                              color: 'transparent',
                              drawBorder: false
                            }
                        },
                        y: {
                          display: false,
                            ticks: {
                              color: 'transparent',
                            },
                            grid: {
                              color: 'transparent',
                                drawBorder: false
                            }
                        }
                    },
                    elements: {
                      point: {
                          radius:0
                      },

                    },
                    layout: {
                      padding: {
                      left: 0,
                      right: 0,
                      top: 5,
                      bottom: 5
                    }
                    }
                  }"

                ></p-chart>
              </div>

            </div>
          </div>

          <div class="card flex" >
            <div class="col-6 py-4 " >
              <div class="row flex justify-content-start align-items-center ml-2">
                <span class="font-bold text-600 text-3xl" pTooltip="Minutos" tooltipPosition="right">{{this.data.qtdAtrasoMes[0] | number: '1.0-0'}} min</span>
              </div>
              <div class="row flex">
                  <span class="text-lg text-600 font-medium ml-2 mr-3 ">Atraso</span>
                  <div class="flex align-items-center">
                   <span [class]="this.data.qtdAtrasoMes[0] < this.data.qtdAtrasoMes[1]? 'backGreen':'backRed'">
                      <i [class]="this.data.qtdAtrasoMes[0] < this.data.qtdAtrasoMes[1]?
                        'pi pi-arrow-down-right text-xs font-bold text-green-500' : 'pi pi-arrow-up-right text-xs font-bold text-red-400'"
                      ></i>
                    </span>
                    <span [class]="this.data.qtdAtrasoMes[0] < this.data.qtdAtrasoMes[1]?
                      'font-medium text-sm text-green-500 ml-1' : 'font-medium text-sm text-red-400 ml-1'"
                      >{{ calculaPorcentagem(this.data.qtdAtrasoMes[0], this.data.qtdAtrasoMes[1]) | percent: '1.1' }}
                    </span>

                  </div>
              </div>
            </div>
            <div class="col-6 flex justify-content-end align-items-center">
              <div class="absolute z-0 px-3">
                <i class="pi pi-clock text-8xl text-100"></i>
              </div>
              <div class="pt-2">
                <p-chart type="line"
                height="80"
                width="180"
                [responsive]="true"
                [data]="{
                  labels: [ '', '', '', '','',''],
                  datasets: [
                    {
                      fill: false,
                      data: [this.data.qtdAtrasoMes[5], this.data.qtdAtrasoMes[4], this.data.qtdAtrasoMes[3], this.data.qtdAtrasoMes[2], this.data.qtdAtrasoMes[1], this.data.qtdAtrasoMes[0]],
                      borderColor: this.data.qtdMes[0] > this.data.qtdMes[1]? '#FF6259':'#4CD07D',
                      tension: 0.4
                    }
                  ],
                }"
                [options]="{
                  hide: false,
                  legend: false,
                  maintainAspectRatio: false,
                  aspectRatio: 2,
                  name: false,
                  plugins: {
                    legend: {
                      display: false
                    }
                  },
                  scales: {
                      x: {
                        display: false,
                        ticks: {
                            color: 'transparent',
                          },
                          grid: {
                            color: 'transparent',
                            drawBorder: false
                          }
                      },
                      y: {
                        display: false,
                          ticks: {
                            color: 'transparent',
                          },
                          grid: {
                            color: 'transparent',
                              drawBorder: false
                          }
                      }
                  },
                  elements: {
                    point: {
                        radius:0
                    },

                  },
                  layout: {
                    padding: {
                    left: 0,
                    right: 0,
                    top: 5,
                    bottom: 5
                  }
                  }
                }"

                ></p-chart>
              </div>

            </div>
          </div>


          <div class="card flex" >
            <div class="col-6 py-4 " >
              <div class="row flex justify-content-start align-items-center ml-2">
                <span class="font-bold text-600 text-3xl">45</span>
              </div>
              <div class="row flex">
                <span class="text-lg text-600 font-medium ml-2 mr-3 ">Não sei</span>
                <div class="flex align-items-center">
                  <span [class]="this.data.qtdMes[1] > this.data.qtdMes[1]? 'backGreen':'backRed'">
                    <i [class]="this.data.qtdMes[1] > this.data.qtdMes[1]?
                      'pi pi-arrow-up-right text-xs font-bold text-green-500' : 'pi pi-arrow-down-right text-xs font-bold text-red-400'"
                    ></i>
                  </span>
                  <span [class]="this.data.qtdMes[1] > this.data.qtdMes[1]?
                    'font-medium text-sm text-green-500 ml-1' : 'font-medium text-sm text-red-400 ml-1'"
                    >{{ calculaPorcentagem(200, 203) | percent: '1.1' }}
                  </span>

                </div>
              </div>
            </div>

            <div class="col-6 flex justify-content-end align-items-center">
              <div class="absolute z-0 px-3">
                <i class="pi pi-shopping-cart text-8xl text-100"></i>
              </div>
              <div class="pt-2">
                <p-chart type="line"
                height="80"
                width="180"
                [responsive]="true"
                [data]="{
                  labels: [ '', '', '', '','',''],
                  datasets: [
                    {
                      fill: false,
                      data: [35, 41, 37, 33, 39, 35],
                      borderColor: '#FF6259',
                      tension: 0.4
                    }
                  ],
                }"
                [options]="{
                  maintainAspectRatio: false,
                  aspectRatio: 3,
                  name: false,
                  plugins: {
                    legend: {
                      display: false
                    }
                  },
                  scales: {
                      x: {
                        display: false,
                        ticks: {
                            color: 'transparent',
                          },
                          grid: {
                            color: 'transparent',
                            drawBorder: false
                          }
                      },
                      y: {
                        display: false,
                          ticks: {
                            color: 'transparent',
                          },
                          grid: {
                            color: 'transparent',
                              drawBorder: false
                          }
                      }
                  },
                  elements: {
                    point: {
                        radius:0
                    },

                  },
                  layout: {
                    padding: {
                    left: 0,
                    right: 0,
                    top: 5,
                    bottom: 5
                  }
                  }
                }"

                ></p-chart>
              </div>
            </div>
          </div>


          <div class="card flex" >
            <div class="col-7 py-4 " >
              <div class="row flex justify-content-start align-items-center ">
                <span class="font-bold text-600 text-3xl ml-2">{{this.data.qtdFaturamentoMes[0] | currency:'BRL':true:'1.2-2'}}</span>

              </div>
              <div class="row flex">
                <span class="text-lg text-600 font-medium ml-2 mr-3 ">Faturamento</span>
                <div class="flex align-items-center">
                  <span [class]="this.data.qtdFaturamentoMes[0] > this.data.qtdFaturamentoMes[1]? 'backGreen':'backRed'">
                    <i [class]="this.data.qtdFaturamentoMes[0] > this.data.qtdFaturamentoMes[1]?
                      'pi pi-arrow-up-right text-xs font-bold text-green-500' : 'pi pi-arrow-down-right text-xs font-bold text-red-400'"
                    ></i>
                  </span>
                  <span [class]="this.data.qtdFaturamentoMes[0] > this.data.qtdFaturamentoMes[1]?
                    'font-medium text-sm text-green-500 ml-1' : 'font-medium text-sm text-red-400 ml-1'"
                    >{{ calculaPorcentagem(this.data.qtdFaturamentoMes[0], this.data.qtdFaturamentoMes[1]) | percent: '1.1' }}
                  </span>

                </div>
              </div>
            </div>

            <div class="col-5 flex justify-content-end align-items-center">
              <div class="absolute z-0">
                <i class="pi pi-dollar text-8xl text-100"></i>
              </div>
              <div class="pt-2">
                <p-chart type="line"
                height="80"
                width="148"
                [responsive]="true"
                [data]="{
                  labels: [ '', '', '', '','',''],
                  datasets: [
                    {
                      fill: false,
                      data: [this.data.qtdFaturamentoMes[5], this.data.qtdFaturamentoMes[4], this.data.qtdFaturamentoMes[3], this.data.qtdFaturamentoMes[2], this.data.qtdFaturamentoMes[1], this.data.qtdFaturamentoMes[0]],
                      borderColor: this.data.qtdFaturamentoMes[0] > this.data.qtdFaturamentoMes[1]?'#4CD07D':'#FF6259',
                      tension: 0.4
                    }
                  ],
                }"
                [options]="{
                  maintainAspectRatio: false,
                  aspectRatio: 3,
                  name: false,
                  plugins: {
                    legend: {
                      display: false
                    }
                  },
                  scales: {
                      x: {
                        display: false,
                        ticks: {
                            color: 'transparent',
                          },
                          grid: {
                            color: 'transparent',
                            drawBorder: false
                          }
                      },
                      y: {
                        display: false,
                          ticks: {
                            color: 'transparent',
                          },
                          grid: {
                            color: 'transparent',
                              drawBorder: false
                          }
                      }
                  },
                  elements: {
                    point: {
                        radius:0
                    },

                  },
                  layout: {
                    padding: {
                    left: 0,
                    right: 0,
                    top: 5,
                    bottom: 5
                  }
                  }
                }"

                ></p-chart>
              </div>
            </div>
          </div>
    </div>

    <div class="row lg:flex">
        <div class="md:col-12 lg:col-9">

          <div class=" line">
            <span class="cardTitulo mb-2">Total de Consultas</span>
            <p-chart
              height="350"
              type="line"
              [data]="dataLine"
              [options]="basicOptions"
              ></p-chart>
          </div>
          <div class=" bar lg:mt-4">
            <span class="cardTitulo mb-2">Consultas por Dentista</span>
            <p-chart
              height="400"
              type="line"
              [data]="dataLineDent"
              [options]="basicOptionsDent"
            ></p-chart>
          </div>
        </div>

        <div class="md:col-12 lg:col-3">
          <div class="card doughnut ">
            <span class="cardTitulo mb-2">Procedimentos</span>
            <p-chart
              type="doughnut"
              [data]="dataDoughnut"
              [options]="basicOptionsPie"
            ></p-chart>
          </div>
          <div class="card doughnut mt-4">
            <span class="cardTitulo mb-2">Especialidades</span>
            <p-chart
              type="pie"
              [data]="dataPie"
              [options]="basicOptionsPie"
            ></p-chart>
          </div>
          <div class="card doughnut mt-4">
            <span class="cardTitulo mb-2">Nao sei</span>
            <p-chart
              type="pie"
              [data]="dataPie"
              [options]="basicOptionsPie"
            ></p-chart>
          </div>
        </div>
    </div>
  </div>

</div>
